{%- comment -%}
  Description:
    Adds Liquid object data as JSON in HTML script tags.
    Should be added directly after <head> tag in theme.liquid, checkout.liquid, and any other layout files for the theme

  Example usage:
  {% render 'os-data' %}
{%- endcomment -%}

{%- if template -%}
  <script data-type="template" type="application/json" >{{- template | json -}}</script>
{% endif %}
{%- if cart -%}
  <script data-type="cart" type="application/json" >{{- cart | json -}}</script>
{% endif %}

{%- if checkout -%}
  <script data-type="checkout" type="application/json" >{
    "customer": {
      "id": {{- checkout.customer.id | json -}},
      "accepts_marketing": {{- checkout.customer.accepts_marketing | json -}},
      "addresses": {{- checkout.customer.addresses | json -}},
      "addresses_count": {{- checkout.customer.addresses_count | json -}},
      "default_address": {{- checkout.customer.default_address | json -}},
      "first_name": {{- checkout.customer.first_name | json -}},
      "has_account": {{- checkout.customer.has_account | json -}},
      "last_name": {{- checkout.customer.last_name | json -}},
      "name": {{- checkout.customer.name | json -}},
      "orders_count": {{- checkout.customer.orders_count | json -}},
      "phone": {{- checkout.customer.phone | json -}},
      "tags": {{- checkout.customer.tags | json -}},
      "tax_exempt": {{- checkout.customer.tax_exempt | json -}},
      "total_spent": {{- checkout.customer.total_spent | json -}}
    },
    "line_items": [
      {%- for line_item in checkout.line_items -%}
      {
        "compare_at_price": "{{- line_item.variant.compare_at_price | json -}}",
        "position": {{- forloop.index0 -}},
        "sku": {{- line_item.sku | json -}},
        "type": {{- line_item.product.type | json -}},
        "product_id": {{- line_item.product_id | json -}},
        "variant_id": "{{- line_item.variant_id -}}",
        "title": {{- line_item.product.title | json -}},
        "vendor": {{- line_item.vendor | json -}},
        "variant": {{- line_item.variant | json -}}
        "final_price": "{{- line_item.final_price | json -}}",
        "quantity": "{{- line_item.quantity | json -}}",
        "image": "{{- line_item.image | image_url -}}",
        "osUserId": "{{ line_item.properties._os_user_id }}",
        "osAnonymousId": "{{ line_item.properties._os_anonymous_id }}"
      }{% unless forloop.last %},{% endunless %}
      {%- endfor -%}
    ],
    ],
    "id": {{- checkout.id | json -}},
    "total_price": {{- checkout.total_price | json -}},
    "order": {{- checkout.order | json -}},
    "order_id": {{- checkout.order_id | json -}},
    "order_name": {{- checkout.order_name | json -}},
    "order_number": {{- checkout.order_number | json -}},
    "email": "{{ checkout.email }}"
  }</script>
{% endif %}
{%- if search -%}
  <script data-type="search" type="application/json" >{{- search | json -}}</script>
{% endif %}
{%- if theme -%}
  <script data-type="theme" type="application/json" >{
    "id": {{- theme.id | json -}},
    "name": {{- theme.name | json -}}
  }</script>
{% endif %}
{%- if routes -%}
  <script data-type="routes" type="application/json" >{
    "account_addresses_url": "{{ routes.account_addresses_url }}",
    "account_login_url": "{{ routes.account_login_url }}",
    "acount_logout_url": "{{ routes.acount_logout_url }}",
    "account_recover_url": "{{ routes.account_recover_url }}",
    "account_register_url": "{{ routes.account_register_url }}",
    "account_url": "{{ routes.account_url }}",
    "all_products_collection_url": "{{ routes.all_products_collection_url }}",
    "cart_add_url": "{{ routes.cart_add_url }}",
    "cart_change_url": "{{ routes.cart_change_url }}",
    "cart_clear_url": "{{ routes.cart_clear_url }}",
    "cart_url": "{{ routes.cart_url }}",
    "collections_url": "{{ routes.collections_url }}",
    "predictive_search_url": "{{ routes.predictive_search_url }}",
    "product_recommendations_url": "{{ routes.product_recommendations_url }}",
    "root_url": "{{ routes.root_url }}",
    "search_url": "{{ routes.search_url }}"
  }</script>
{% endif %}
